<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
	<meta charset="UTF-8">
	<title layout:title-pattern="$CONTENT_TITLE - MyApp">MyApp</title>
	<link rel="stylesheet" th:href="@{/css/styles.css}" />
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
	<style>
		body {
			height: 100%;
		}

		.layout-root {
			min-height: 100vh;
			display: flex;
			flex-direction: column;
		}

		/* Header */
		.site-header {
			background-color: #0d6efd;
			/* Bootstrap primary */
			color: #fff;
			padding: 0.75rem 1rem;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		/* Main container: sidebar + content */
		.main-container {
			flex: 1;
			display: flex;
			min-height: 0;
			/* fix flexbox overflow */
		}

		/* Sidebar */
		.main-container .left-menu {
			width: 240px;
			background: #f8f9fa;
			border-right: 1px solid #dee2e6;
			padding: 1rem;
		}

		.main-container .left-menu .nav-link {
			color: #333;
			padding: 0.5rem 0.75rem;
			border-radius: 6px;
			margin-bottom: 0.25rem;
			transition: background 0.2s;
		}

		.main-container .left-menu .nav-link:hover {
			background: rgba(13, 110, 253, 0.08);
			color: #0d6efd;
		}

		.main-container .left-menu .nav-link.active {
			background: #0d6efd;
			color: #fff;
		}

		/* Content */
		main.content {
			flex: 1;
			padding: 1.5rem;
			background-color: #ffffff;
		}

		/* Footer */
		.site-footer {
			background: #f8f9fa;
			padding: 0.75rem 1rem;
			border-top: 1px solid #dee2e6;
			text-align: center;
			font-size: 0.875rem;
			color: #6c757d;
		}

		/* Responsive behavior */
		@media (max-width: 991.98px) {
			.main-container {
				flex-direction: column;
			}

			.main-container .left-menu {
				width: 100%;
				border-right: none;
				border-bottom: 1px solid #dee2e6;
			}
		}

		.toast-container {
			position: fixed;
			top: 0;
			right: 0;
			z-index: 999;
		}

		.toast-message-container {
			margin: 10px;
			padding: 10px;
			border-radius: 5px;
			box-shadow: 1px 2px #0000004c;
			background: #fff;
			color: red;
		}
	</style>
</head>

<body>
	<div class="layout-root">
		<div th:replace="~{layouts/fragments/header :: header}" class="site-header"></div>
		<div class="main-container">
			<!-- Left Menu Fragment -->
			<div th:replace="~{layouts/fragments/left-menu :: left-menu}"></div>

			<!-- Content Section -->
			<main class="content" layout:fragment="content">
			</main>
		</div>
		<div th:replace="~{layouts/fragments/footer :: footer}" class="site-footer"></div>

		<div th:if="${!#strings.isEmpty(errorMsg)}" class="toast-container">
			<div class="toast-message-container" th:text="${errorMsg}"></div>
		</div>
		<!-- Scripts -->
		    <script th:src="@{/plugins/jquery/jquery.min.js}"></script>
		    <script th:src="@{/plugins/bootstrap/js/bootstrap.bundle.min.js}"></script>
		    <div layout:fragment="scripts">
		    	<script>
		            $(document).ready(function() {
		                var currentPath = window.location.pathname;
		                
		                if (currentPath !== '/' && currentPath.endsWith('/')) {
		                    currentPath = currentPath.slice(0, -1);
		                }
		                
		                $('#leftMenu .nav-link').each(function() {
		                    var link = $(this);
		                    var linkPath = link.attr('href');
		                    
		                    if (linkPath !== '/' && linkPath.endsWith('/')) {
		                        linkPath = linkPath.slice(0, -1);
		                    }
		                    
		                    if (linkPath === currentPath) {
		                        link.addClass('active');
		                        
		                        if (link.parent().hasClass('sub-menu')) {
		                            link.closest('.collapse').addClass('show');
		                            link.closest('.collapse').prev('.dropdown-toggle').addClass('active');
		                        }
		                    }
		                });
		                
		                $('.dropdown-toggle').click(function() {
		                    $('.dropdown-toggle').not(this).removeClass('active');
		                    $(this).toggleClass('active');
		                });
		            });
		        </script>
	</div>
</body>

</html>



