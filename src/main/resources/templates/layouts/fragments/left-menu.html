<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <!-- Bootstrap 5 CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <!-- Font Awesome (optional — used for icons in this example) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* small styling for chevron rotation */
    .toggler-icon { transition: transform .18s ease; }
    .toggler-icon.rotated { transform: rotate(180deg); }
    /* optional: indent submenu links */
    .sidebar .collapse .nav-link { padding-left: 1.25rem; }
  </style>
</head>
<body>
  <th:block th:fragment="left-menu">
    <aside class="sidebar bg-light">
      <nav class="nav flex-column py-3" id="leftMenu">
        <a class="nav-link" th:href="@{/}">
          <i class="fas fa-tachometer-alt me-1"></i> Dashboard
        </a>

        <!-- Product -->
        <div class="mb-2">
          <a class="nav-link d-flex justify-content-between align-items-center"
             href="#" 
             data-bs-toggle="collapse" 
             data-bs-target="#productSubmenu"
             aria-expanded="false"
             aria-controls="productSubmenu">
            <span><i class="fas fa-box me-1"></i> Product</span>
            <i class="fas fa-chevron-down toggler-icon small"></i>
          </a>
          <div class="collapse" id="productSubmenu">
            <a class="nav-link" th:href="@{/product-setup}"><i class="fas fa-cog me-1"></i> Product Setup</a>
            <a class="nav-link" th:href="@{/product-list}"><i class="fas fa-list me-1"></i> Product List</a>
          </div>
        </div>

        <!-- User -->
        <div class="mb-2">
          <a class="nav-link d-flex justify-content-between align-items-center"
             href="#"
             data-bs-toggle="collapse"
             data-bs-target="#userSubmenu"
             aria-expanded="false"
             aria-controls="userSubmenu">
            <span><i class="fas fa-user me-1"></i> User</span>
            <i class="fas fa-chevron-down toggler-icon small"></i>
          </a>
          <div class="collapse" id="userSubmenu">
            <a class="nav-link" th:href="@{/user_setup}"><i class="fas fa-cog me-1"></i> User Setup</a>
            <a class="nav-link" th:href="@{/user_list}"><i class="fas fa-list me-1"></i> User List</a>
          </div>
        </div>

        <!-- Role -->
        <div class="mb-2">
          <a class="nav-link d-flex justify-content-between align-items-center"
             href="#"
             data-bs-toggle="collapse"
             data-bs-target="#roleSubmenu"
             aria-expanded="false"
             aria-controls="roleSubmenu">
            <span><i class="fas fa-user-shield me-1"></i> Role</span>
            <i class="fas fa-chevron-down toggler-icon small"></i>
          </a>
          <div class="collapse" id="roleSubmenu">
            <a class="nav-link" th:href="@{/role_setup}"><i class="fas fa-cog me-1"></i> Role Setup</a>
            <a class="nav-link" th:href="@{/role_list}"><i class="fas fa-list me-1"></i> Role List</a>
          </div>
        </div>

        <!-- Item -->
        <div class="mb-2">
          <a class="nav-link d-flex justify-content-between align-items-center"
             href="#"
             data-bs-toggle="collapse"
             data-bs-target="#itemSubmenu"
             aria-expanded="false"
             aria-controls="itemSubmenu">
            <span><i class="fas fa-boxes me-1"></i> Item</span>
            <i class="fas fa-chevron-down toggler-icon small"></i>
          </a>
          <div class="collapse" id="itemSubmenu">
            <a class="nav-link" th:href="@{/item-setup}"><i class="fas fa-cog me-1"></i> Item Setup</a>
            <a class="nav-link" th:href="@{/item-list}"><i class="fas fa-list me-1"></i> Item List</a>
          </div>
        </div>

      </nav>
    </aside>
  </th:block>

  <!-- Bootstrap Bundle JS (includes Popper) -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

  <script>
  (function(){
    var sidebar = document.querySelector('.sidebar');
    if(!sidebar) return;

    // Close open submenus when clicking outside on small screens (< 992px)
    document.addEventListener('click', function(e){
      if(window.innerWidth >= 992) return; // only on small screens
      if(sidebar.contains(e.target)) return; // clicked inside sidebar — ignore
      // find any visible collapse panels inside the sidebar and hide them
      var openCollapses = sidebar.querySelectorAll('.collapse.show');
      openCollapses.forEach(function(el){
        var bs = bootstrap.Collapse.getInstance(el) || new bootstrap.Collapse(el, {toggle:false});
        bs.hide();
      });
    });

    // rotate chevron when submenu opens/closes
    sidebar.querySelectorAll('[data-bs-toggle="collapse"]').forEach(function(toggle){
      var targetSelector = toggle.getAttribute('data-bs-target');
      if(!targetSelector) return;
      var target = document.querySelector(targetSelector);
      if(!target) return;
      target.addEventListener('show.bs.collapse', function(){ toggle.querySelector('.toggler-icon')?.classList.add('rotated'); });
      target.addEventListener('hide.bs.collapse', function(){ toggle.querySelector('.toggler-icon')?.classList.remove('rotated'); });
    });
  })();
  </script>
</body>
</html>
